<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QR-Based Food Ordering</title>
    <link rel="stylesheet" href="CSS/styles.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" crossorigin="anonymous">


    <header id="header-mobile" class="light fixed-top">
      <div class="module module-logo">
          <a href="index.html">
              <img src="assets/img/mobile-logo.jpeg" alt="">
          </a>
      </div>
  </header>
  </head>

  <body>
    <div class="content">
      <div id="menu-header" class="page-title">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 offset-lg-4">
                    <div class="mb-0 main">Our Menu</div>
                    <div class="mb-0 sub-title">The Taste of Mumbai in Every Bite!</div>
                </div>
            </div>
        </div>
      </div>

      <div id="menu" class="custom-container">

        <div id="menu-list" class="d-flex justify-content-between flex-wrap categories-div p-2"></div>
       
        <div class="row" id="category-nav-container" style="display: none">
          <div class="col-12 navbar-menu-category fixed-top">
            <div class="order-title">
              <div class="main">Order</div>
            </div>
              <div class="menu-category d-flex flex-nowrap">
                <div class="item-category text-nowrap" category-name="misal-pav" id="misal-pav">Misal Pav</div>
                <div class="item-category text-nowrap" category-name="samosa" id="samosa">Samosa</div>
                <div class="item-category text-nowrap" category-name="pav-bhaji" id="pav-bhaji">Pav Bhaji</div>
                <div class="item-category text-nowrap" category-name="sandwiches" id="sandwiches">Sandwiches</div>
                <div class="item-category text-nowrap" category-name="drinks" id="drinks">Drinks</div>
                <div class="item-category text-nowrap" category-name="chai" id="chai">Chai</div>
                <div class="item-category text-nowrap" category-name="bhel" id="bhel">Mumbaiya Bhel</div>
              </div>
          </div>
          <div id="menu-category-wise-list" class="row"></div>
        </div>

        <div class="action-buttons">
          <button onclick="viewCart()">View Cart</button>
        </div>
      </div>

      <div class="home-cart fixed-bottom">
        <div class="mob-footer">
          <div role="presentation" id="menu-nav-item" onclick="goBack()" class="nav-item u_cursor_pointer active">
            <img src="assets/home.svg" alt="home">
            <p class="mob-footer-label takeaway">Menu</p>
          </div>
          <div role="presentation" id="search-nav-item" class="nav-item u_cursor_pointer">
            <img src="assets/search.svg" alt="offers">
            <p class="mob-footer-label ">Search</p>
          </div>
          <div role="presentation" id="cart-nav-item" class="nav-item u_cursor_pointer" onclick="viewCart()">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
              <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
            </svg>
            <p class="mob-footer-label">Cart</p>
          </div>
        </div>
      </div>

      <div id="cart" class="custom-container" style="display: none">
        <h3>Your Order</h3>
        <div id="cart-list"></div>
        <h5>Total: ₹<span id="cart-total">0</span></h5>
        <div class="action-buttons">
          <button id="place-order" onclick="placeOrder()" disabled>
            Place Order
          </button>
          <button class="bg-dark" onclick="goBack()">Back to Menu</button>
        </div>
      </div>

      <div id="order-success" class="custom-container" style="display: none">
        <h1>Order Placed Successfully!</h1>
        <p>Thank you for your order.</p>
        <div class="action-buttons">
          <button onclick="goBack(true)">Back to Menu</button>
        </div>
      </div>

  <footer class="footer">
    <p>&copy; 2025 Cafe - FreeLancers. All rights reserved.</p>
  </footer>
</body>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>

      <script>
        const menuItems = [
          {
            id: 1,
            name: "Samosa",
            price: 5,
            desc: "Juicy grilled burger with cheese",
            img: "assets/img/item1.jpg",
            category: "Samosa"
          },
          {
            id: 2,
            name: "Misal Pava",
            price: 8,
            desc: "Delicious cheesy pizza with toppings",
            img: "assets/img/item1.jpg",
            category: "misal-pav"
          },
          {
            id: 3,
            name: "Sandwich",
            price: 7,
            desc: "Creamy Alfredo pasta with herbs",
            img: "assets/img/item1.jpg",
            category: "sandwiches"
          },
          {
            id: 4,
            name: "Sp. pav bhaji",
            price: 4,
            desc: "Fresh garden salad with dressing",
            img: "assets/img/item1.jpg",
            category: "pav-bhaji"
          },
        ];

        let cart = [];

        function displayMenu2(category = '', update = 0) {
          document.getElementById('menu-nav-item').click();
          document.getElementById("category-nav-container").setAttribute("style","display: block !important");
          document.getElementById("menu-list").setAttribute("style","display: none !important");
          document.getElementById("menu-header").setAttribute("style","display: none !important");

          const menuList = document.getElementById("menu-category-wise-list");
          menuList.innerHTML = "";
          menuCategory = menuItems;
          category = category.toLowerCase().trim();
          let found = menuItems.find((item) => item.category.toLowerCase() === category);
          if(!found){
            let div = document.createElement("div");
            div.innerHTML = '<div>Category not found</div>';
            menuList.append(div)
            return;
          }
          menuCategory = menuItems.filter((item) => item.category.toLowerCase().trim() === category);
  
          menuCategory.forEach((item, index) => {
            let found = cart.find((cartItem) => cartItem.id === item.id);
            let quantity = found ? found.quantity : 0;
            let div = document.createElement("div");
            // div.classList.add("menu-item");
            div.classList.add("col-12");
            div.classList.add("col-md-6");
            div.innerHTML = `
                    <div class="cardd row mb-2">
                      <div class="col-4 col-md-4">
                        <img width="96" height="96" class="br-item" alt="${item.name}" src="${item.img}">
                      </div>
                      <div class="cardd-body col-8 col-md-8">
                        <div class="cardd-details">
                          <div class="cardd-title fs-20 fw-600">${item.name}</div>
                          <div>
                            <p class="cardd-text fs-15"> ${item.desc} </p>
                          </div>
                        </div>
                        <div class="cardd-footer-custom">
                          <div class="left-item">
                            <span class="fw-600"> ₹${item.price}</span>
                          </div>
                        
                          <div class="menuu-actions">
                              ${
                                quantity > 0
                                  ? `<div class='quantity'>
                                      <button onclick='updateMenuQuantity(${item.id}, -1, "${item.category}")'>-</button>
                                      <span>${quantity}</span>
                                      <button onclick='updateMenuQuantity(${item.id}, 1, "${item.category}")'>+</button>
                                  </div>`
                                  : `<button class='add-btn' onclick='updateMenuQuantity(${item.id}, 1, "${item.category}")'>Add</button>`
                              }
                          </div>
                          </div>
                        </div>
                      </div>`;
            menuList.appendChild(div);
          });
        }

        function displayMenu() {
          document.getElementById('menu-nav-item').click();
          
          document.getElementById("category-nav-container").setAttribute("style","display: none !important");
          document.getElementById("menu-list").setAttribute("style","display: flex !important");
          document.getElementById("menu-header").setAttribute("style","display: block !important");

          const menuList = document.getElementById("menu-list");
          menuList.innerHTML = "";

          menuItems.forEach((item, index) => {
            let div = document.createElement("div");
            div.classList.add("item-category");
            div.setAttribute("category-name", `${item.category}`);
            div.innerHTML = `
                            <img width="96" height="96" class="br-item" alt="${item.name}" src="${item.img}">
                            <p>${item.category}</p>
                            `;
            menuList.appendChild(div);
          });
        }

        function viewCart() {
          document.getElementById('cart-nav-item').click();
          document.getElementById("menu-header").style.display = "none";
          document.getElementById("menu").style.display = "none";
          document.getElementById("cart").style.display = "block";
          const cartList = document.getElementById("cart-list");
          const placeOrderBtn = document.getElementById("place-order");

          cartList.innerHTML = "";

          if (cart.length === 0) {
            cartList.innerHTML =
              "<p>Your cart is empty. Please select items from the menu.</p>";
            document.getElementById("cart-total").innerText = "0";

            placeOrderBtn.disabled = true;
            placeOrderBtn.classList.add("disabled-btn"); // Apply gray effect
            return;
          }

          let total = 0;
          cart.forEach((item, index) => {
            total += item.price * item.quantity;
            let div = document.createElement("div");
            div.classList.add("cart-item");
            div.classList.add("col-12");
            div.classList.add("col-md-6");
            div.innerHTML = `
                    <div class="cardd row mb-2">
                      <div class="col-4 col-md-4">
                        <img width="96" height="96" class="br-item" alt="${item.name}" src="${item.img}">
                      </div>
                      <div class="cardd-body col-8 col-md-8">
                        <div class="cardd-details">
                          <div class="cardd-title fs-20 fw-600">${item.name}</div>
                          <div>
                            <p class="cardd-text fs-15"> ${item.desc} </p>
                          </div>
                        </div>
                        <div class="cardd-footer-custom">
                          <div class="left-item">
                            <span class="fw-600"> ₹${item.price}</span>
                          </div>
                        
                          <div class="menuu-actions">
                              <div class='quantity'>
                                  <button onclick='updateQuantity(${index}, -1)'>-</button>
                                  <span>${item.quantity}</span>
                                  <button onclick='updateQuantity(${index}, 1)'>+</button>
                              </div>
                          </div>
                        </div>
                      </div>`;
            cartList.appendChild(div);
          });

          document.getElementById("cart-total").innerText = total;

          // Enable button and remove gray effect
          placeOrderBtn.disabled = false;
          placeOrderBtn.classList.remove("disabled-btn");
        }

        function findItemById(id, object){
           return object.find((item)=>item.id== id)
        }

        function updateMenuQuantity(id, change, categoryName) {
          let found = findItemById(id, cart)
          if(!found){
            console.log("new item");
            found = findItemById(id, menuItems); 
            index = menuItems.findIndex(x => x.id ===id);
          }

          if (found?.quantity) {
            found.quantity += change;
            if (found.quantity <= 0) {
              cart = cart.filter((item) => item.name !== found.name);
            }
          } else if (change > 0) {
            cart.push({ ...menuItems[index], quantity: 1 });
          }
          displayMenu2(categoryName);
        }

        function updateQuantity(index, change) {
          cart[index].quantity += change;
          if (cart[index].quantity <= 0) {
            cart.splice(index, 1);
          }
          viewCart();
        }

        function goBack(reset = false) {
          if (reset) {
            cart = []; // Reset cart only when coming from the order success page
          }
          displayMenu();
          document.getElementById("menu").style.display = "block";
          document.getElementById("menu-header").style.display = "block";
          document.getElementById("cart").style.display = "none";
          document.getElementById("order-success").style.display = "none";
        }

        function placeOrder() {
          cart = [];
          document.getElementById("cart").style.display = "none";
          document.getElementById("order-success").style.display = "block";
        }

        //For footer nav-bar
        const navLinks = document.querySelectorAll('.nav-item');
        navLinks.forEach(e =>{
          e.addEventListener('click',()=>{
            document.querySelector('.active')?.classList.remove('active');
            e.classList.add('active');
          })
        })
        
        const navCategory = document.querySelectorAll('.item-category');
        navCategory.forEach(e =>{
          e.addEventListener('click',(c)=>{
            document.querySelector('.active')?.classList.remove('active');
            e.classList.add('active');
          })
        })

        $(document).on("click", '.item-category' ,function() {
          const categoryName = $(this).attr('category-name').trim();
          console.log("click",categoryName);
          displayMenu2(categoryName);
        });    
        displayMenu();
      </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</html>
